---
title: "World Leaders Lifespan"
author: "Ethan Shen, Malavi Ravindran, Steven Herrera Tenorio, Anna Darwish"
date: "8/23/2020"
output: 
  pdf_document:
      latex_engine: xelatex
---

```{r, function checking for installed packages, include=FALSE}
pkgTest <- function(x)
{
  if (!require(x,character.only = TRUE))
  {
    install.packages(x,repos = "http://cran.r-project.org", dep=TRUE)
    if(!require(x,character.only = TRUE)) stop("Package not found")
  }
}
```

```{r include=FALSE}
#Installing packages 
pkgTest("readr")
pkgTest("dplyr")
pkgTest("ggplot2")
pkgTest("Epi")
pkgTest("knitr")
pkgTest("lubridate")
pkgTest("R2jags")
pkgTest("tidyr")
pkgTest("kableExtra")
pkgTest("tibble")
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(ggplot2)
library(Epi)
library(knitr)
library(lubridate)
library(R2jags)
library(tidyr)
library(kableExtra)
library(tibble)
```

```{r}
load("Leaders.Rdata")
leaders <- as.data.frame(leaders)
head(leaders)
```

# Update Data

```{r}
prev_date <- as.Date("31/07/2020",format="%d/%m/%Y")
current_date <- as.Date("31/08/2020",format="%d/%m/%Y")

## remove days string and convert to numeric
leaders <- leaders %>% 
  mutate(Age.Event = sub(".*?(\\d+\\.*\\d*).*", "\\1", Age.Event)) %>% data.frame
leaders$Age.Event <- as.numeric(leaders$Age.Event)

## update age event by adding 1/12 to leaders still alive (none died in past month so easy to do case when)
leaders <- leaders %>% 
  mutate(Age.Event = case_when(Event.Date == prev_date ~ Age.Event + 1/12,
                               TRUE ~ Age.Event)) %>% data.frame

## update event dates to be current day since none of the leaders in this set died in the past month
leaders <- leaders %>% 
  mutate(Event.Date = case_when(Event.Date == prev_date ~ as.Date(current_date,format="%d/%m/%Y"),
                                TRUE ~ Event.Date)) %>% data.frame

## update Emperor Jianwen
leaders <- leaders %>% 
  mutate(Fail = case_when(Name == "Jianwen Emperor" ~ 1,
                          TRUE ~ Fail)) %>% data.frame

## multiplying time by 10 
leaders <- leaders %>% 
  mutate(decade = time * 10)
```

# Exploratory Data Analysis

## Distribution of Relative Birth Date

```{r}
ggplot(leaders, aes(x=decade)) + 
  geom_histogram(color="black", fill="white", bins = 10) + 
  labs(title="Distribution of Relative Birth Date") + xlab("Relative Birth Date")
```
## Distributions of Lifespan

```{r}
ggplot(leaders, aes(x=Age.Event)) + 
  geom_histogram(color="black", fill="white", bins = 10) + 
  labs(title="Distribution of Lifespan") + xlab("Lifespan (yrs)")
```

## Distributions of Relative Birth Date Across Leadership Type

```{r}
boxplot(time ~ Type, data = leaders, main="Relative Birth Date vs Type of Leader", ylab="Relative Birth Date", xlab="Leader Type")
```

## Distributions of Lifespan Across Leadership Type

```{r}
boxplot(Age.Event ~ Type, data = leaders, main="Lifespans vs Type of Leader", ylab="Lifespan (yrs)", xlab="Leader Type")
```

## Scatterplot of Lifespan vs Relative Birth Date across Leadership Type

```{r}
ggplot(leaders, aes(x=time, y=Age.Event, shape=Type, color=Type)) +
  geom_point() + labs(title="Lifespan vs Relative Birth Date") + 
  ylab("Lifespan (yrs)") + xlab("Relative Birth Date")
```


## Interaction Plot

```{r}
qplot(x = time, y = Age.Event, data = leaders, color = Type) +
  geom_smooth(method = "lm", se=FALSE) + ylab("Lifespan (yrs)") + xlab("Relative Birth Date")
```

## Lexis Diagrams of Lifespans Across Leadership Type

```{r}
leaderTypeTitles <- c("Popes", "US Presidents", "Chinese Emperors", "Dalai Lamas","Japanese Emperors")
names(leaderTypeTitles) <- c("Pope", "UsPres", "ChinaEmp","DalaiLama","JapanEmp")

plotLifeSpan <- function(leaderType) {
  leaders.lexis <- leaders %>% filter(Type == leaderType) %>% data.frame
  
  # Used code from http://search.r-project.org/library/Epi/html/plot.Lexis.html to generate lexis plot
  leaders.lexis$bt <- as.integer(substring(leaders.lexis$Birth.Date,0,4))
  leaders.lexis$ex <- as.integer(substring(leaders.lexis$Event.Date,0,4))
  
  # Define as Lexis object with timescales calendar time and age
  lifespans <- Lexis( entry = list( per=bt ),
                      exit = list( per=ex, age=Age.Event ),
                      exit.status = Fail,
                      data = leaders.lexis )
  plotTitle = paste0("Lexis Diagram of Lifespans of ",leaderTypeTitles[leaderType])
  plot(lifespans, grid=0:20*5, col='black', xaxs="i", yaxs="i",
       xlim=c(min(leaders.lexis$bt),2030), ylim=c(0,100), lwd=3, las=1 , main=plotTitle,
       ylab="Lifespan (yrs)", xlab="Century") 
  points( lifespans, pch=c(NA,16)[lifespans$lex.Xst+1], col="red", cex=1.5 )
}

for (leaderType in unique(leaders$Type)) {
  plotLifeSpan(leaderType)
}
```

# Modeling 

```{r}
alive = c("Barack Obama","Francis","14th Dalai Lama (Tenzin Gyatso)", "Naruhito (Emperor Reiwa)")
l = leaders[-(leaders$Name %in% alive),]

n <- nrow(l)
#
#
# Censoring
Age.Event <- l$Age.Event
#
censored <- l$Censored
#
survival <- ifelse(censored == 0, Age.Event, NA)
#
censoring_limits <- ifelse(censored == 0, 100, Age.Event)
#
# Covariates (centered)
#
x_1 <- l$time - mean(l$time) # looking at "time" by the decade 
# pope is baseline for type 
x_2 <- l$Type %>% as.factor() %>% relevel("Pope")
```

```{r}
#predictive info for Francis, Obama, and Naruhito

time_DL <- 6.3549350 - mean(leaders$time)
type_DL <- 3
present_length_DL <- 85.153833

#francis
time_Francis <- 6.3694456 - mean(leaders$time)
type_Francis <- 0
present_length_Francis <- 83.702772

#obama
time_Obama <- 6.6157426 - mean(leaders$time)
type_Obama <- 5
present_length_Obama <- 59.073066

#naruhit
time_Naruhito <- 6.6012868 - mean(leaders$time)
type_Naruhito <- 4
present_length_Naruhito <- 60.518652

upper_length <- 100
```

```{r}
data_leaders <- list("n",
                     "censored",
                     "survival",
                     "censoring_limits",
                     "x_1",
                     "x_2", 
                     "time_Francis",
                     "present_length_Francis",
                     "upper_length",
                     "time_Obama",
                     "type_Obama",
                     "time_DL",
                     "type_DL",
                     "present_length_DL",
                     "present_length_Obama",
                     "time_Naruhito",
                     "type_Naruhito",
                     "present_length_Naruhito")
```

## Create Model Text for RJags For Different Priors
```{r}
generate_model_text = function(priors=""){
  model_file <- tempfile()
  
  likelihood = "#Likelihood
  for (i in 1:n){ 

    censored[i] ~ dinterval(survival[i], censoring_limits[i]) 
    survival[i] ~ dweib(r, mu[i]) # Basic Weibull assumption
    mu[i] <- exp(beta[i])  # Defining beta as log(mu)
    beta[i] <- beta_0 + beta_1*x_1[i] + beta_type[x_2[i]] + beta_int[x_2[i]] * x_1[i] 

  }
    
  #Priors
  beta_type[1] <- 0
  beta_int[1] <- 0
  "
  
  predicted_survivals = "
  #Define the alphas
  alpha_0 <- - beta_0 / r
  alpha_1 <- - beta_1 / r
  percentage_increase_birthyr <- 100*(exp(alpha_1) - 1)
  for (i in 2:5) {
    alpha_type[i] <- - beta_type[i] / r
    alpha_int[i] <- -beta_int[i] / r
    percentage_increase_type[i] <- 100*(exp(alpha_type[i]) - 1)
    percentage_increase_int[i] <- 100*(exp(alpha_int[i]) - 1)
  }
  
  beta_Francis <- beta_0 + beta_1*time_Francis 
  mu_Francis <- exp(beta_Francis)
  survival_Francis ~ dweib(r, mu_Francis)T(present_length_Francis, upper_length)
  
  beta_Obama <- beta_0 + beta_1*time_Obama + 
    beta_type[type_Obama] + beta_int[type_Obama]*time_Obama
  mu_Obama <- exp(beta_Obama)
  survival_Obama ~ dweib(r, mu_Obama)T(present_length_Obama, upper_length)
  
  beta_Naruhito <- beta_0 + beta_1*time_Naruhito + beta_type[type_Naruhito] +
    beta_int[type_Naruhito]*time_Naruhito
  mu_Naruhito <- exp(beta_Naruhito)
  survival_Naruhito ~ dweib(r, mu_Naruhito)T(present_length_Naruhito, upper_length)
  
  beta_DL <- beta_0 + beta_1*time_DL + beta_type[type_DL] + beta_int[type_DL]*time_DL
  mu_DL <- exp(beta_DL)
  survival_DL ~ dweib(r, mu_DL)T(present_length_DL, upper_length)
  "
  
model_text <- paste("model{ ",likelihood, priors, predicted_survivals, "}")
writeLines(model_text,con=model_file)
return(model_file)
}
```

## Create Model From RJags

```{r}
generate_model = function(priors="",model_name=""){
  model_file <- generate_model_text(priors)
  if (file.exists(model_name)) {
    load(file = model_name)
  } 
  else {
  
  rjags_model <- jags(data = data_leaders,  
                              parameters.to.save = c("beta_0",
                                                     "beta_1",
                                                     "beta_type",
                                                     "beta_int",
                                                     "r",
                                                     "survival_Francis",
                                                     "survival_Obama",
                                                     "survival_Naruhito",
                                                     "survival_DL",
                                                     "alpha_0",
                                                     "alpha_1",
                                                     "percentage_increase_birthyr",
                                                     "alpha_type",
                                                     "alpha_int",
                                                     "percentage_increase_type",
                                                     "percentage_increase_int"
                              ), 
                              n.iter = 100000, 
                              n.chains = 3,
                              model.file = model_file)
  save(rjags_model, file = model_name)
  }
  return(rjags_model)
}
```

## Display Clean Model Output From RJAGS
```{r}
display_model_output = function(model){
  model$BUGSoutput$summary %>% 
    as.data.frame() %>% 
    select(-`25%`, -`75%`) %>% 
    knitr::kable()
}
```

## Model 1a: rexp(0.001), Betas: N(0,1)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 1)
    beta_int[i] ~ dnorm(0.0, 1)
  }
  
  beta_0 ~ dnorm(0.0, 1) # Prior on beta_0 is normal with low precision
  beta_1 ~ dnorm(0.0, 1) # Prior on beta_1 is normal with low precision
  
  # http://mikemeredith.net/blog/2017/Categories_in_JAGS.htm
  # potentially set different prior for dalai lamas (negative mean or somethin)
  
  r ~ dexp(0.001) # Prior on r
  "
Bayesian_Leaders_V1a <- generate_model(priors,"leaders_model_r_1e-3_beta_1.Rdata")
Bayesian_Leaders_V1a
```

## Model 1b: rexp(0.001), Betas: N(0,100)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, .01)
    beta_int[i] ~ dnorm(0.0, .01)
  }
  
  beta_0 ~ dnorm(0.0, .01) # Prior on beta_0 is normal with low precision
  beta_1 ~ dnorm(0.0, .01) # Prior on beta_1 is normal with low precision
  
  # http://mikemeredith.net/blog/2017/Categories_in_JAGS.htm
  # potentially set different prior for dalai lamas (negative mean or somethin)
  
  r ~ dexp(0.001) # Prior on r
  "
Bayesian_Leaders_V1b <- generate_model(priors,"leaders_model_r_1e-3_beta_100.Rdata")
Bayesian_Leaders_V1b
```



```{r}
## WORK IN PROGRESS - table doesn't knit in a pdf 
bugs1 <- Bayesian_Leaders_V1$BUGSoutput$summary %>% 
  as.data.frame() 
bugs1 <- bugs1[c(14, 1:2, 8:12, 3:7),]

bugs1 <- bugs1 %>% 
  tibble::rownames_to_column("Parameter") %>% 
  mutate_if(is.numeric, round, digits = 3) %>% 
  mutate("95% CI" = paste0("(", `2.5%`, ", ", `97.5%`,  ")")) %>% 
  select(-(`2.5%`:`97.5%`)) %>% 
  select(Parameter, mean, sd, `95% CI`, Rhat) %>% 
  tibble::column_to_rownames("Parameter")

row.names(bugs1) <- c("$r$", "$\\beta_0$", "$\\beta_1$", 
                      "$\\beta_{21}$","$\\beta_{22}$","$\\beta_{23}$","$\\beta_{24}$","$\\beta_{25}$",
                      "$\\beta_{31}$","$\\beta_{32}$","$\\beta_{33}$","$\\beta_{34}$","$\\beta_{35}$")

# filters out dummy parameters (beta_21, beta_31)
bugs1 %>% 
  filter(sd != 0) %>% 
  knitr::kable(booktabs=T, 
               col.names = c("Estimate", "Std. Deviation", "95% CI", "$\\hat{R}$"),
               row.names = T) 
```


## Posterior Predictive Distribution (Francis' Lifespan)

```{r}
ggplot(post_values_V1) +
  geom_histogram(aes(x = survival_Francis)) # this kinda makes sense?? I guess we wnat things to look "approx normal"
```


## Model 3a - rexp(0.1), Betas: N(0,1)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 1)
    beta_int[i] ~ dnorm(0.0, 1)
  }
  
  beta_0 ~ dnorm(0.0, 1)
  beta_1 ~ dnorm(0.0, 1)
  
  r ~ dexp(0.1) # Prior on r
  "
Bayesian_Leaders_V3a <- generate_model(priors,"leaders_model_r_1e-1_beta_1.Rdata")
Bayesian_Leaders_V3a
```

## Model 3b - rexp(0.1), Betas: N(0,100)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, .01)
    beta_int[i] ~ dnorm(0.0, .01)
  }
  
  beta_0 ~ dnorm(0.0, .01)
  beta_1 ~ dnorm(0.0, .01)
  
  r ~ dexp(0.1) # Prior on r
  "
Bayesian_Leaders_V3b <- generate_model(priors,"leaders_model_r_1e-1_beta_100.Rdata")
Bayesian_Leaders_V3b
```


## Model 4a - rexp(1), Betas: N(0,1)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 1)
    beta_int[i] ~ dnorm(0.0, 1)
  }
  
  beta_0 ~ dnorm(0.0, 1)
  beta_1 ~ dnorm(0.0, 1)
  
  r ~ dexp(1) # Prior on r
  "
Bayesian_Leaders_V4a <- generate_model(priors,"leaders_model_r_1_beta_1.Rdata")
Bayesian_Leaders_V4a
```

## Model 4b - rexp(1), Betas: N(0,100)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 100)
    beta_int[i] ~ dnorm(0.0, 100)
  }
  
  beta_0 ~ dnorm(0.0, .01)
  beta_1 ~ dnorm(0.0, .01)
  
  r ~ dexp(1) # Prior on r
  "
Bayesian_Leaders_V4b <- generate_model(priors,"leaders_model_r_1_beta_100.Rdata")
Bayesian_Leaders_V4b
```


## Model 5a - rexp(2), Betas: N(0,1)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 1)
    beta_int[i] ~ dnorm(0.0, 1)
  }
  
  beta_0 ~ dnorm(0.0, 1)
  beta_1 ~ dnorm(0.0, 1)
  
  r ~ dexp(2) # Prior on r
  "
Bayesian_Leaders_V5a <- generate_model(priors,"leaders_model_r_2_beta_1.Rdata")
Bayesian_Leaders_V5a
```

## Model 5b - rexp(2), Betas: N(0,100)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 0.01)
    beta_int[i] ~ dnorm(0.0, 0.01)
  }
  
  beta_0 ~ dnorm(0.0, 0.01)
  beta_1 ~ dnorm(0.0, 0.01)
  
  r ~ dexp(2) # Prior on r
  "
Bayesian_Leaders_V5b <- generate_model(priors,"leaders_model_r_2_beta_100.Rdata")
Bayesian_Leaders_V5b
```

## Model 6a - r=gamma(10,0.5), Betas: N(0,1)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 1)
    beta_int[i] ~ dnorm(0.0, 1)
  }
  
  beta_0 ~ dnorm(0.0, 1)
  beta_1 ~ dnorm(0.0, 1)
  
  r ~ dgamma(10,0.5) # Prior on r
  "
Bayesian_Leaders_V6a <- generate_model(priors,"leaders_model_r_10_5e-1_beta_1.Rdata")
Bayesian_Leaders_V6a
```

## Model 6b - r=gamma(10,0.5), Betas: N(0,100)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 0.01)
    beta_int[i] ~ dnorm(0.0, 0.01)
  }
  
  beta_0 ~ dnorm(0.0, 0.01)
  beta_1 ~ dnorm(0.0, 0.01)
  
  r ~ dgamma(10,0.5) # Prior on r
  "
Bayesian_Leaders_V6b <- generate_model(priors,"leaders_model_r_10_5e-1_beta_100.Rdata")
Bayesian_Leaders_V6b
```

## Model 7a - r=gamma(25,0.2), Betas: N(0,1)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 1)
    beta_int[i] ~ dnorm(0.0, 1)
  }
  
  beta_0 ~ dnorm(0.0, 1)
  beta_1 ~ dnorm(0.0, 1)
  
  r ~ dgamma(25,0.2) # Prior on 
  "
Bayesian_Leaders_V7a <- generate_model(priors,"leaders_model_r_25_2e-1_beta_1.Rdata")
Bayesian_Leaders_V7a
```

## Model 7b - r=gamma(25,0.2), Betas: N(0,100)

```{r}
priors <- "
  for(i in 2:5) {
    beta_type[i] ~ dnorm(0.0, 0.01)
    beta_int[i] ~ dnorm(0.0, 0.01)
  }
  
  beta_0 ~ dnorm(0.0, 0.01)
  beta_1 ~ dnorm(0.0, 0.01)
  
  r ~ dgamma(25,0.2) # Prior on r
  "
Bayesian_Leaders_V7b <- generate_model(priors,"leaders_model_r_25_2e-1_beta_100.Rdata")
Bayesian_Leaders_V7b
```

# Model Analysis

## Traceplots 

```{r}
model_trace_plots = function(model){
  post_values = model$BUGSoutput$sims.matrix %>% 
  as.data.frame() %>% 
  mutate(i = row_number())

post_values %>% 
  tidyr::gather(key, value, "beta_0", "beta_1", "r", -i) %>% 
  ggplot() + 
  geom_line(aes(x = i, y = value, color = key)) + 
  facet_grid(key~., scales = "free_y")

post_values %>% 
  tidyr::gather(key, value, `beta_type[2]`:`beta_type[5]`, -i) %>% 
  ggplot() + 
  geom_line(aes(x = i, y = value, color = key)) + 
  facet_grid(key~., scales = "free_y")

post_values %>% 
  tidyr::gather(key, value, `beta_int[2]`:`beta_int[5]`, -i) %>% 
  ggplot() + 
  geom_line(aes(x = i, y = value, color = key)) + 
  facet_grid(key~., scales = "free_y")
}
model_trace_plots(Bayesian_Leaders_V1a)
model_trace_plots(Bayesian_Leaders_V1b)
```

# Sensitivy Analysis - Need to fix

```{r}
# sensitivity_analysis <- function(parameter_values, )
# results_v1 <- as.data.frame(Bayesian_Leaders_V1$BUGSoutput$sims.matrix)
# results_v2 <- as.data.frame(Bayesian_Leaders_V2$BUGSoutput$sims.matrix)
# francis_results <- c(results_v1$survival_Francis, results_v2$survival_Francis)
# 
# models <- c("model1", "model2")
# names(models) <- c("0.01", "1")
# 
# df <- data.frame(matrix(ncol = 2, nrow = length(results_v1$survival_Francis)))
# x <- c("model1","model2")
# colnames(df) <- x
# 
# df$low_var <- results_v1$survival_Francis
# df$high_var <- results_v1$survival_Francis
# par(mfrow = c(1, 2))
# for(r_val in c("0.001","1")){
#     hist(df$low_var)
# }
```
# Answering Questions

```{r}
# probability that the 14th Dalai Lama will have a longer lifespan than Pope Francis

survival_DL <- Bayesian_Leaders_V1a$BUGSoutput$sims.matrix[,"survival_DL"]
survival_Francis <- Bayesian_Leaders_V1a$BUGSoutput$sims.matrix[,"survival_Francis"]


DL_vs_francis <- survival_DL - survival_Francis
diffData <- as.data.frame(DL_vs_francis)
ggplot(diffData, aes(x = DL_vs_francis, y = ..density..)) + geom_histogram(binwidth = 3) + labs(x = "Difference in Predicted Survival Times between Dalai Lama and rancisPredictive Probability density", title = "Figure 4") 


#probability that Obama will live longer thatn Naruhito

survival_Obama <- Bayesian_Leaders_V1a$BUGSoutput$sims.matrix[,"survival_Obama"]
survival_Naruhito <- Bayesian_Leaders_V1a$BUGSoutput$sims.matrix[,"survival_Naruhito"]

mean(survival_Obama > survival_Naruhito)
med <- median(survival_Obama > survival_Naruhito)

Obama_vs_naruhito <- survival_Obama - survival_Naruhito
diffData <- as.data.frame(Obama_vs_naruhito)
ggplot(diffData, aes(x = Obama_vs_naruhito, y = ..density..)) + geom_histogram(binwidth = 3) + labs(x = "Difference in Predicted Survival Times between Obama and Naruhito", y = "Predictive Probability density", title = "Figure 4") 
```

```{r}
#interpretation of parameters- split into two tables

#INTERPRETATIONS OF INTERACTION EFFECTS
bugs_for_interpretation <- Bayesian_Leaders_V1a$BUGSoutput$summary %>% 
  as.data.frame()
time_coeff_mean <- bugs_for_interpretation["beta_1",][,"mean"]
intercept_mean <- bugs_for_interpretation["beta_0",][,"mean"]
r_mean <- bugs_for_interpretation["r",][,"mean"]


#Popes
multiplicative_scale_factor_birthyear_pope <- exp(time_coeff_mean*(-1)/r_mean)
percent_increase_birthyear_pope <- (multiplicative_scale_factor_birthyear_pope-1)*100

#Chinese Emperors
beta_int_2_coeff_mean <- bugs_for_interpretation["beta_int[2]",][,"mean"]
multiplicative_scale_factor_birthyear_chinese_emperor <- exp((time_coeff_mean + beta_int_2_coeff_mean) *(-1)/r_mean)
percent_increase_birthyear_chinese_emperor <- (multiplicative_scale_factor_birthyear_chinese_emperor-1)*100

#Dalai Lamas
beta_int_3_coeff_mean <- bugs_for_interpretation["beta_int[3]",][,"mean"]
multiplicative_scale_factor_birthyear_DL <- exp((time_coeff_mean + beta_int_3_coeff_mean) *(-1)/r_mean)
percent_increase_birthyear_DL <- (multiplicative_scale_factor_birthyear_DL-1)*100

#Japanese Emperors
beta_int_4_coeff_mean <- bugs_for_interpretation["beta_int[4]",][,"mean"]
multiplicative_scale_factor_birthyear_japanese_emperor <- exp((time_coeff_mean + beta_int_4_coeff_mean) *(-1)/r_mean)
percent_increase_birthyear_japanese_emperor <- (multiplicative_scale_factor_birthyear_japanese_emperor-1)*100

#US President
beta_int_5_coeff_mean <- bugs_for_interpretation["beta_int[5]",][,"mean"]
multiplicative_scale_factor_birthyear_us_pres <- exp((time_coeff_mean + beta_int_5_coeff_mean) *(-1)/r_mean)
percent_increase_birthyear_us_pres <- (multiplicative_scale_factor_birthyear_us_pres-1)*100

scale_factors <- c(multiplicative_scale_factor_birthyear_pope, multiplicative_scale_factor_birthyear_chinese_emperor, multiplicative_scale_factor_birthyear_DL, multiplicative_scale_factor_birthyear_japanese_emperor, multiplicative_scale_factor_birthyear_us_pres)

percent_increase <- c(percent_increase_birthyear_pope, percent_increase_birthyear_chinese_emperor, percent_increase_birthyear_DL, percent_increase_birthyear_japanese_emperor, percent_increase_birthyear_us_pres)

leader_type <- c("Pope", "Chinese Emperor", "Dalai Lama", "Japanese Emperor", "US President")

scale_and_percent <- data.frame(leader_type, scale_factors, percent_increase)
scale_and_percent 
  
```
